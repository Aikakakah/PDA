@import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap');

:root{
    --bg: #111111;
    --pda-bg: #1f1f22;
    --panel: #242427;
    --inner: #2b2b2e;
    --accent: #5e2b63; /* default purple-ish */
    --muted: #a9a9a9;
    --text: #e6e6e6;
    --danger: #e06c75;
    --ok: #6ad07a;
    --info: #4ac7d0; /* Blue for roles */
    --width: 576px;
    --height: 450px;
    --radius: 10px;
    --book-width: 300px; /* Width of the book */
    --book-height: 400px; /* Height of the book */
    font-family: 'Share Tech Mono', ui-monospace, monospace;
}

html,body{height:100%;margin:0;background:var(--bg);color:var(--text);-webkit-font-smoothing:antialiased}
/* CHANGE: Use Flexbox to center and align the PDA and Book */
body{display:flex;align-items:center;justify-content:center;overflow:hidden; gap: 40px;}

/* PDA window shell */
/* CHANGE: Remove absolute positioning from PDA */
.pda{
    /* position:absolute; <--- REMOVED */
    width:var(--width);
    height:var(--height);
    border-radius:calc(var(--radius) + 6px);
    padding:8px;
    box-shadow:0 8px 28px rgba(0,0,0,.7), 0 0 10px rgba(0,0,0,.4);
    background: linear-gradient(180deg, #2b0d23 0%, #2b0d23 100%); /* outer frame */
    box-sizing:border-box;
    user-select:none;
    transition: filter 0.3s;
    /* REMOVE absolute positioning rules */
    left: initial !important;
    top: initial !important;
}
.pda.powered-off{filter:brightness(0.3);} /* Dim when powered off */

/* --- NEW BOOK WIDGET STYLES --- */
.book-widget {
    display: flex;
    flex-direction: column;
    width: var(--book-width);
    height: var(--book-height);
    background: #1a1a1b; /* Dark background */
    border: 3px solid var(--accent);
    border-radius: 6px;
    box-shadow: 0 8px 20px rgba(0,0,0,.5);
    padding: 10px;
}

.book-controls {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 5px 0 10px;
    border-bottom: 1px solid #333;
    color: var(--muted);
    font-size: 14px;
}

.book-controls button {
    background: transparent;
    border: none;
    color: var(--accent);
    cursor: pointer;
    font-size: 1.2em;
    padding: 5px;
}
.book-controls button:disabled {
    color: #444;
    cursor: default;
}
.book-controls button:hover:not(:disabled) {
    color: var(--text);
}

.book-page {
    flex-grow: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    cursor: pointer; /* Cursor indicates interactivity */
}

.book-page img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
    transition: opacity 0.3s ease-in-out;
}
/* --- END BOOK WIDGET STYLES --- */


/* inner container (display) */
.content, .header, .footer, .prog-header{box-sizing:border-box}
/* ... (Rest of existing CSS styles remain unchanged) ... */
.header{
    height:44px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    background:var(--panel);
    border-radius:6px;
    padding:6px 8px;
    gap:8px;
    cursor:grab;
    border:2px solid rgba(0,0,0,0.4);
    box-shadow: inset 0 -2px 0 rgba(0,0,0,0.2);
}

/* accent bars */
.accent-h{position:absolute;left:8px;right:8px;top:8px;height:8px;background:var(--accent);border-radius:6px;opacity:0.95}
.accent-v{position:absolute;top:8px;bottom:8px;right:8px;width:8px;background:var(--accent);border-radius:6px;opacity:0.95}

/* header left nav */
.header .left{display:flex;gap:6px;align-items:center}
.nav-btn{
    display:flex;align-items:center;justify-content:center;
    width:34px;height:34px;border-radius:6px;border:none;background:transparent;color:var(--text);cursor:pointer;
    transition:background .12s, color .12s, transform .06s;
}
.nav-btn:hover{background:rgba(255,255,255,0.02)}
.nav-btn[aria-pressed="true"]{background:var(--inner);border:1px solid var(--accent)}

/* title center */
.title{font-size:14px;opacity:0.95}

/* header right icons */
.header .right{display:flex;gap:6px;align-items:center}
.icon{
    width:34px;height:34px;border-radius:6px;background:transparent;border:none;color:var(--text);cursor:pointer;display:flex;align-items:center;justify-content:center;
}
.icon:active{transform:translateY(1px)}
.icon[aria-pressed="true"]{color:var(--accent)} /* Toggle icon style */

.small{background:transparent;border:none;color:var(--text);cursor:pointer;padding:6px 8px;border-radius:6px}

/* prog header (mini) */
.prog-header{height:36px;margin-top:6px;background:var(--inner);display:flex;align-items:center;justify-content:space-between;padding:6px;border-radius:6px;border:1px solid rgba(0,0,0,0.25)}
.mini-info{display:flex;align-items:center;gap:8px}

/* content area */
.content{
    background:linear-gradient(180deg,var(--inner),#232325);
    margin-top:6px;
    border-radius:8px;
    padding:12px;
    height: calc(100% - 140px);
    overflow:hidden;
    border:2px solid rgba(0,0,0,0.3);
    box-shadow: inset 0 -6px 12px rgba(0,0,0,0.35);
}

/* view management */
.view{display:none;height:100%;overflow:auto}
.view.active{display:block}
.inner{display:flex;flex-direction:column;gap:8px;padding-right:6px}

/* info lines */
.info-line{font-size:15px;color:var(--muted)}
.info-line strong{color:var(--text);width:120px;display:inline-block}

/* alert colors */
.alert.green{color:var(--ok)}
.alert.red{color:var(--danger)}
.job{color:#f2d54a}

/* program grid */
.program-grid{display:grid;grid-template-columns:1fr 1fr;gap:8px}
.tile{
    background:#2b2b2f;border:1px solid rgba(255,255,255,0.03);padding:12px;border-radius:6px;display:flex;align-items:center;gap:10px;cursor:pointer;
    transition: background 0.1s;
}
.tile .glyph{width:44px;height:44px;border-radius:6px;background:linear-gradient(#272729,#333336);display:flex;align-items:center;justify-content:center;font-weight:700;color:var(--muted);font-size:1.5em;}
.tile .label{font-size:15px;color:var(--text)}
.tile:hover{background:linear-gradient(#333235,#3a3a3d)}

/* settings list */
.settings-list{display:flex;flex-direction:column;gap:8px}
.setting-row{background:#2b2b2f;padding:10px;border-radius:6px;border:1px solid rgba(255,255,255,0.03);display:flex;align-items:center;justify-content:space-between;cursor:pointer;}
.setting-row:hover{background:#3a3a3e}
.setting-title{font-size:14px;color:var(--text)}
.setting-desc{font-size:12px;color:var(--muted)}

/* program area (cartridge) */
.program-area{height:100%;background:linear-gradient(180deg,#1e1e1f,#1a1a1b);border-radius:6px;padding:10px;color:var(--text);overflow:auto}
.program-area .cartridge-header{font-weight:700;margin-bottom:8px;font-size:1.2em;color:var(--accent)}

/* Notekeeper UI specific */
.notekeeper{display:flex;flex-direction:column;height:100%}
.notes-wrap{flex:1;overflow:auto;padding:6px;display:flex;flex-direction:column;gap:6px}
.note{background:#333336;padding:8px;border-radius:6px;display:flex;justify-content:space-between;align-items:center}
.note button{border:none;background:transparent;color:#ff7777;font-weight:700;cursor:pointer}
.note-input{margin-top:8px;display:flex;gap:6px}
.note-input input{flex:1;padding:8px;border-radius:6px;border:1px solid rgba(255,255,255,0.04);background:#222;color:var(--text);outline:none;font-family:inherit;}
/* STYLING FOR NOTEKEEPER ADD BUTTON */
.note-input button {
    padding: 8px 12px;
    border-radius: 6px;
    border: none;
    background: var(--accent); /* Use accent color for button */
    color: #fff;
    cursor: pointer;
    font-family: inherit;
    font-weight: bold;
    transition: background 0.1s;
}
.note-input button:hover {
    background: #7a3c80; /* Slightly lighter on hover */
}


/* Crew Manifest UI specific */
.crew-manifest{height:100%; display: flex; flex-direction: column;}
.manifest-list{flex:1; overflow-y: auto; display:flex;flex-direction:column;gap:4px;font-size:0.9em;}
.manifest-list h4{color:var(--info);margin:10px 0 2px;border-bottom:1px solid #333}
.manifest-entry{display:flex;justify-content:space-between;padding:4px 0;border-bottom:1px dotted #333;align-items:center;}
.manifest-entry .name{font-weight:bold;color:var(--text);}
.manifest-entry .role{color:var(--muted);font-size:0.85em;}
.manifest-entry .rank{color:var(--info);font-weight:bold;}

/* NanoChat UI specific */
.nanochat{display:flex;flex-direction:column;height:100%;background:#1a1a1b;border-radius:6px;overflow:hidden;}
.chat-header{padding:8px;background:#242427;border-bottom:1px solid #333;font-weight:bold;color:var(--text)}
.chat-body{flex:1;display:flex;overflow:hidden;}
.chat-sidebar{width:120px;background:#1e1e1f;border-right:1px solid #333;overflow-y:auto;}
.chat-contact{padding:8px 10px;cursor:pointer;font-size:0.9em;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.chat-contact:hover{background:#2b2b2e}
.chat-contact.active{background:var(--accent);color:#fff;border-left:3px solid var(--text);}
.chat-messages{flex:1;padding:10px;overflow-y:auto;display:flex;flex-direction:column;gap:8px;}
.message-row{display:flex;max-width:80%;}
.message-row.sent{margin-left:auto;}
.message-bubble{padding:6px 10px;border-radius:12px;font-size:0.9em;line-height:1.4;}
.message-bubble.received{background:#333336;border-top-left-radius:2px;}
.message-bubble.sent{background:var(--accent);color:#fff;border-top-right-radius:2px;}
.chat-input-wrap{padding:8px;background:#242427;display:flex;gap:8px;border-top:1px solid #333;}
.chat-input-wrap input{flex:1;border-radius:20px;padding:6px 12px;border:none;background:#333;color:var(--text);outline:none;}
.chat-input-wrap button{background:var(--accent);border:none;border-radius:50%;width:30px;height:30px;color:#fff;cursor:pointer;font-weight:bold;font-size:1.1em;}

/* Station News UI specific */
.station-news{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;text-align:center;}
.news-title{font-size:1.5em;color:var(--accent);margin-bottom:10px;}
.news-content{padding:20px;background:#333336;border-radius:6px;width:80%;margin-bottom:20px;font-size:0.9em;}
.news-controls{display:flex;gap:20px;font-size:1.5em;}
.news-controls button{background:transparent;border:none;color:var(--accent);cursor:pointer;}

/* footer */
.footer{height:34px;margin-top:6px;background:linear-gradient(180deg,#141414,#101010);border-radius:6px;padding:6px 10px;display:flex;justify-content:space-between;align-items:center;border:1px solid rgba(255,255,255,0.02);font-size:13px;color:var(--muted)}

/* chip */
.chip{background:rgba(255,255,255,0.03);padding:6px 8px;border-radius:6px;font-size:13px;color:var(--text)}

/* power overlay */
.power-overlay{
    position:absolute;inset:0;background:rgba(0,0,0,0.85);display:flex;align-items:center;justify-content:center;border-radius:calc(var(--radius) + 6px);
}
.power-box{background:#111;padding:20px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);display:flex;flex-direction:column;align-items:center;gap:12px}
.power-icon{font-size:36px;color:var(--muted)}
.power-text{color:var(--muted)}
.power-btn{padding:8px 12px;border-radius:6px;border:none;background:var(--accent);color:#fff;cursor:pointer}

/* Modal Styling (Ringtone) */
.modal{
    position:absolute;inset:0;background:rgba(0,0,0,0.7);display:flex;align-items:center;justify-content:center;
    z-index:100;
}
.modal-content{
    background:var(--panel);padding:20px;border-radius:8px;border:2px solid var(--accent);
    width:250px;display:flex;flex-direction:column;align-items:center;gap:15px;position:relative;
}
.modal-close{position:absolute;top:5px;right:5px;font-size:1.5em;color:var(--muted);transition:color 0.1s;}
.modal-close:hover{color:var(--danger);}
.modal-title{font-size:1.3em;color:var(--accent);font-weight:bold;}
.ringtone-notes{display:flex;gap:8px;}
.ringtone-notes span{background:#333;padding:5px 10px;border-radius:4px;color:var(--info);font-weight:bold;}
.modal-actions{display:flex;gap:10px;}
.action-btn{padding:8px 15px;border-radius:6px;border:none;background:var(--accent);color:#fff;cursor:pointer;}
.action-btn:hover{background:#7a3c80;}


/* utility */
.hidden{display:none}
.program-mini{font-size:12px;color:var(--muted);margin-left:8px}

@media (max-width:960px){
    /* Adjust layout for smaller screens to stack the PDA and Book */
    body {
        flex-direction: column;
        gap: 20px;
    }
}

@media (max-width:600px){
    :root{--width:92vw;--height:86vh}
    .pda{width:92vw;height:86vh}
    .program-grid{grid-template-columns:1fr}
}

/* --- Scrollbar Styling for Webkit Browsers (Chrome, Safari, Edge) --- */

/* Track */
::-webkit-scrollbar {
    width: 8px;
    height: 8px;
    background: transparent; /* Makes the main track area invisible */
}

/* Handle (The movable part) */
::-webkit-scrollbar-thumb {
    background: #444448; /* Darker than the panel, but lighter than the track */
    border-radius: 10px;
    border: 2px solid var(--inner); /* Creates a dark border to match the background */
}

/* Handle on hover */
::-webkit-scrollbar-thumb:hover {
    background: #55555c; /* Slightly lighter on hover */
}

/* Corner (where vertical and horizontal meet) */
::-webkit-scrollbar-corner {
    background: transparent;
}

/* Hide scrollbar in Firefox for a cleaner look, but keep scrolling functional */
.view, .notes-wrap, .chat-messages, .manifest-list {
    scrollbar-width: thin; /* "auto" or "thin" */
    scrollbar-color: #444448 var(--inner); /* thumb color track color */
}