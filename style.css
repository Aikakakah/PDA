@import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap');

:root{
   --bg: #461a1a;
   --pda-bg: #1f1f22;
   --panel: #242427;
   --inner: #2b2b2e;
   --accent: #5e2b63; /* default purple-ish */
   --muted: #a9a9a9;
   --text: #e6e6e6;
   --danger: #e06c75;
   --ok: #6ad07a;
   --info: #4ac7d0; /* Blue for roles */
   --width: 576px;
   --height: 450px;
   --radius: 10px;
   /* ðŸš€ NEW: DEFINE YOUR SCALING FACTOR HERE (e.g., 25% = 0.25) */
  --scale-factor: 0.37; 
  /* * CALCULATED BOOK SIZE (1104x1452 original image size)
   * Single Page Width: 1104px * var(--scale-factor)
   * Single Page Height: 1452px * var(--scale-factor)
   */
  /* **Full Book Width (2 pages):** 2 * 1104px * scale-factor */
  --book-width: calc(2 * 1104px * var(--scale-factor)); 
  /* **Full Book Height (1 page):** 1452px * scale-factor */
  --book-height: calc(1452px * var(--scale-factor)); 
   font-family: 'Share Tech Mono', ui-monospace, monospace;
}

html,body{
  height:100%;
  margin:0;
  background:var(--bg);
  color:var(--text);
  -webkit-font-smoothing:antialiased}
/* CHANGE: Use Flexbox to center and align the PDA and Book */
body{
  display:flex;
  align-items:center;
  justify-content:center;
  overflow:hidden; 
  min-height: 100vh;
  margin: 0;
  padding: 0;
  gap: 20px;
  overflow-x: hidden; }

/* PDA window shell */
/* CHANGE: Remove absolute positioning from PDA */
.pda{
   /* position:absolute; <--- REMOVED */
   display: flex;
   justify-content: center; /* Centers horizontally */
   align-items: center; /* Centers vertically */
   width:var(--width);
   height:var(--height);
   border-radius:calc(var(--radius) + 6px);
   padding:8px;
   box-shadow:0 8px 28px rgba(0,0,0,.7), 0 0 10px rgba(0,0,0,.4);
   background: linear-gradient(180deg, rgb(70, 22, 57) 0%, #250b1e 100%); /* outer frame */
   box-sizing:border-box;
   user-select:none;
   transition: filter 0.3s;
   /* REMOVE absolute positioning rules */
   left: initial !important;
   top: initial !important;
}
.pda.powered-off{filter:brightness(0.3);} /* Dim when powered off */

/* --- STPAGEFLIP BOOK WIDGET STYLES --- */
.book-widget {
   display: flex;
   flex-direction: column;
   width: var(--book-width);
   height: var(--book-height);
   max-width: calc(100vw - 80px);
   max-height: calc(100vh - 100px);
   /* background: #660009;  */
   /* border: 3px solid var(--accent); */
   border-radius: 2px;
   /* box-shadow: 0 8px 20px rgba(0,0,0,.5); */
   padding: 2px;
   /* FIX: Ensure the book is on top and can receive click/drag events */
   position: relative; 
   z-index: 2;
}

.book-page {
   flex-grow: 1;
   position: relative; 
   display: block; 
   /* FIX: Remove 'overflow: hidden' which was clipping the 3D flip animation */
   overflow: visible; 
   /* ADD: Ensure the element is set up for 3D transforms */
   transform-style: preserve-3d;
   cursor: grab; /* Indicates drag interactivity */
}

/* STPAGEFLIP SPECIFIC PAGE AND IMAGE STYLES */
/* .my-page is the container for each individual page in StPageFlip */
.my-page {
  width: 100%;
  height: 100%;
  background-color: var(--pda-bg); /* Use dark PDA background for inner pages */
  border: none; /* Let the library handle the cover and page boundaries */
  overflow: hidden;
  padding: 0;
}
.my-page::before {
  content: ""; /* Required for pseudo-elements to render */
  position: absolute; /* Allows for precise placement */
  top: 0;
  bottom: 0;
  /* The key here is to give it the dimensions of the whole page */
  width: 100%;
  height: 100%;
  pointer-events: none; /* Allows clicks to pass through to the page */
  }

/* 1. Page Content Wrapper */
.page-content {
  width: 100%;
  height: 100%;
  display: flex; 
  justify-content: center; /* Center the image horizontally */
  align-items: center; /* Center the image vertically */
  padding: 0; 
}
.my-page.inner-cover-front::after {
  content: "";
  position: absolute;
  inset: 0;
  background: rgba(0, 0, 0, 0.001); /* not visible, but fixes inset rendering */
  pointer-events: none;
  z-index: 2;
  box-shadow: inset -20px 0 40px -7px rgba(67, 16, 16, 0.9);
}
.my-page.inner-cover-back::after {
  content: "";
  position: absolute;
  inset: 0;
  background: rgba(0, 0, 0, 0.001); /* not visible, but fixes inset rendering */
  pointer-events: none;
  z-index: 2;
  box-shadow: inset 20px 0 40px -7px rgba(67, 16, 16, 0.9);
}
.my-page.p1::after {
  content: "";
  position: absolute;
  inset: 0;
  background: rgba(0, 0, 0, 0.001); /* not visible, but fixes inset rendering */
  pointer-events: none;
  z-index: 2;
  box-shadow: inset 3px 0 15px -3px rgba(0, 0, 0, 0.5),inset 10px 0 25px -7px rgba(109, 83, 59, 0.7);
}


/* 2. Page Image (Your img tags) */
.my-page img {
  display: block;
  width: 100%;
  height: 100%;
  /* 'cover' ensures the image fills the area without blank space, clipping as necessary */
  object-fit: cover; 
  margin: 0;
}

/* 3. Cover Overrides (Based on st.pageflip's hard/cover styles) */
.my-page.page-cover {
  background-color: #333336;
}

.my-page.page-cover-top {
  box-shadow: inset 0px 0 35px 0px rgba(0, 0, 0, 0.9), -5px 0 10px 2px rgba(0, 0, 0, 0.7);
}

.my-page.page-cover-bottom {
  box-shadow: inset 0px 0 35px 0px rgba(0, 0, 0, 0.9), 10px 0 10px 0px rgba(0, 0, 0, 0.7);
}

/* Paper Page Shadows*/
.my-page.page-left::before {
    box-shadow: inset -7px 0 25px -7px rgba(109, 83, 59, 0.7);
    box-shadow: inset -3px 0 20px -3px rgba(0, 0, 0, 0.5);
    box-shadow: inset -1px 0 20px -3px rgba(0, 0, 0, 0.7);
}

.my-page.page-right::before {
    box-shadow: inset 7px 0 25px -7px rgba(109, 83, 59, 0.7);
    box-shadow: inset 3px 0 20px -3px rgba(0, 0, 0, 0.5);
    box-shadow: inset 1px 0 20px -3px rgba(0, 0, 0, 0.7);
}

/* --- END STPAGEFLIP BOOK WIDGET STYLES --- */


/* inner container (display) */
.content, .header, .footer, .prog-header{box-sizing:border-box}
.header{
   height:44px;
   display:flex;
   align-items:center;
   justify-content:space-between;
   background:var(--panel);
   border-radius:6px;
   padding:6px 8px;
   gap:8px;
   cursor:grab;
   border:2px solid rgba(0,0,0,0.4);
   box-shadow: inset 0 -2px 0 rgba(0,0,0,0.2);
}
/* PDA Screen */
.PDA-screen {
  display: inline-block;   /* shrink-wrap to content */
  background: rgb(18, 18, 18);
  border-radius: 8px;
  padding: 4px;
  margin: 0 auto;
  /* border: 6px solid rgb(9, 255, 0); */
  position: relative;      /* keep relative for overlays */
  overflow: hidden;       /* allow elements to overflow */
  box-shadow: inset 0 -6px 12px rgba(0,0,0,0.35);
  width: 535px;
  height: 380px;
}

.PDA-screen::before {
  content: '';
  position: absolute;
  width: 10%; /* Width of the shine */
  height: 100%;
  right:-30%;
  background: rgba(255, 255, 255, 0.055);
  /* background: linear-gradient(to right, rgba(255, 255, 255, 0) 0%, rgba(255, 255, 255, 0.5) 50%, rgba(255, 255, 255, 0) 100%); */
  transform: skewX(20deg); /* Optional: Adds a slanted look to the shine */
}

.PDA-screen.shine-active::before {
  animation: slide 1.5s;
}
@keyframes slide {
  0% {
    left: -10%;
  }
  100% {
    left: 110%;
  }
}
.PDA-screen::before {
  animation: none;
}

/* header left nav */
.header .left{display:flex;gap:6px;align-items:center}
.nav-btn{
   display:flex;align-items:center;justify-content:center;
   width:34px;height:34px;border-radius:6px;border:none;background:transparent;color:var(--text);cursor:pointer;
   transition:background .12s, color .12s, transform .06s;
}
.nav-btn:hover{background:rgba(255,255,255,0.02)}
.nav-btn[aria-pressed="true"]{background:var(--inner);border:1px solid var(--accent)}

/* title center */
.title{font-size:14px;opacity:0.95}

/* header right icons */
.header .right{display:flex;gap:6px;align-items:center}
.icon{
   width:34px;height:34px;border-radius:6px;background:transparent;border:none;color:var(--text);cursor:pointer;display:flex;align-items:center;justify-content:center;
}
.icon:active{transform:translateY(1px)}
.icon[aria-pressed="true"]{color:var(--accent)} /* Toggle icon style */

.small{background:transparent;border:none;color:var(--text);cursor:pointer;padding:6px 8px;border-radius:6px}

/* prog header (mini) */
.prog-header{height:36px;margin-top:6px;background:var(--inner);display:flex;align-items:center;justify-content:space-between;padding:6px;border-radius:6px;border:1px solid rgba(0,0,0,0.25)}
.mini-info{display:flex;align-items:center;gap:8px}

/* content area */
.content{
   background:linear-gradient(180deg,var(--inner),#232325);
   border-radius:8px;
   padding:12px;
   height: 300px;
   overflow:hidden;
   border:2px solid rgba(0,0,0,0.3);
   box-shadow: inset 0 -3px 6px rgba(0,0,0,0.35);
   position: relative;
   flex-grow: 1;
}

/* view management */
.view{
  display:none;
  height:100%;
  overflow: hidden;
}
.view.active{display:block}
.inner{display:flex;flex-direction:column;gap:8px;padding-right:6px}

/* info lines */
.info-line{font-size:15px;color:var(--muted)}
.info-line strong{color:var(--text);width:130px;display:inline-block}

/* alert colors */
.alert.green{color:var(--ok)}
.alert.red{color:var(--danger)}
.job{color:#f2d54a}

/* program grid */
.program-grid{display:grid;grid-template-columns:1fr 1fr;gap:8px}
.tile{
   background:#2b2b2f;border:1px solid rgba(255,255,255,0.03);padding:12px;border-radius:6px;display:flex;align-items:center;gap:10px;cursor:pointer;
   transition: background 0.1s;
}
.tile .glyph{width:44px;height:44px;border-radius:6px;background:linear-gradient(#272729,#333336);display:flex;align-items:center;justify-content:center;font-weight:700;color:var(--muted);font-size:1.5em;}
.tile .label{font-size:15px;color:var(--text)}
.tile:hover{background:linear-gradient(#333235,#3a3a3d)}

/* settings list */
.settings-list{display:flex;flex-direction:column;gap:8px}
.setting-row{background:#2b2b2f;padding:10px;border-radius:6px;border:1px solid rgba(255,255,255,0.03);display:flex;align-items:center;justify-content:space-between;cursor:pointer;}
.setting-row:hover{background:#3a3a3e}
.setting-title{font-size:14px;color:var(--text)}
.setting-desc{font-size:12px;color:var(--muted)}

/* program area (cartridge) */
.program-area{
  height:100%;
  background:linear-gradient(180deg,#1e1e1f,#1a1a1b);
  border-radius:6px;
  padding:5px;
  color:var(--text);overflow:auto
}
.program-area .cartridge-header{font-weight:700;margin-bottom:8px;font-size:1.2em;color:var(--accent)}

/* Notekeeper UI specific */
.notekeeper{display:flex;flex-direction:column;height:100%}
.notes-wrap{flex:1;overflow:auto;padding:6px;display:flex;flex-direction:column;gap:6px}
.note{background:#333336;padding:8px;border-radius:6px;display:flex;justify-content:space-between;align-items:center}
.note button{border:none;background:transparent;color:#ff7777;font-weight:700;cursor:pointer}
.note-input{margin-top:8px;display:flex;gap:6px}
.note-input input{flex:1;padding:8px;border-radius:6px;border:1px solid rgba(255,255,255,0.04);background:#222;color:var(--text);outline:none;font-family:inherit;}
/* STYLING FOR NOTEKEEPER ADD BUTTON */
.note-input button {
   padding: 8px 12px;
   border-radius: 6px;
   border: none;
   background: var(--accent); /* Use accent color for button */
   color: #fff;
   cursor: pointer;
   font-family: inherit;
   font-weight: bold;
   transition: background 0.1s;
}
.note-input button:hover {
   background: #7a3c80; /* Slightly lighter on hover */
}
/* 1. Container setup: Flex column to stack elements vertically */
.notekeeper-container {
    display: flex;
    flex-direction: column;
    /* * The program area (#programArea) must have a defined height for 
     * this to work (e.g., height: 100%;). 
     */
    height: 100%; 
    padding: 0 10px 10px 10px; 
    box-sizing: border-box;
}

/* 2. Scrollable Content: Takes up remaining space and handles overflow */
.notekeeper-container .notes-wrap {
    flex-grow: 1; /* Key: Makes this element fill all vertical space */
    overflow-y: auto; /* Key: Enables scrolling */
    margin-bottom: 5px; /* Add small space above the input bar */
    padding-right: 5px; /* Space for scrollbar */
}

/* 3. Static Footer: Input bar styling */
.notekeeper-container .note-input {
    display: flex;
    padding-top: 5px;
    border-top: 1px solid var(--panel); /* Separation line */
    flex-shrink: 0; /* Key: Prevents this element from shrinking */
}

.notekeeper-container .note-input input {
    flex-grow: 1;
    margin-right: 5px;
}

.notekeeper-container .note-input button {
    flex-shrink: 0;
    width: 50px; 
}


/* Crew Manifest UI specific */
.crew-manifest{height:100%; display: flex; flex-direction: column;}
.manifest-list{flex:1; overflow-y: auto; display:flex;flex-direction:column;gap:4px;font-size:0.9em;}
.manifest-list h4{color:var(--info);margin:10px 0 2px;border-bottom:1px solid #333}
.manifest-entry{display:flex;justify-content:space-between;padding:4px 0;border-bottom:1px dotted #333;align-items:center;}
.manifest-entry .name{font-weight:bold;color:var(--text);}
.manifest-entry .role{color:var(--muted);font-size:0.85em;}
.manifest-entry .rank{color:var(--info);font-weight:bold;}

/* NanoChat UI specific */
.nanochat{display:flex;flex-direction:column;height:100%;background:#1a1a1b;border-radius:6px;overflow:hidden;}
.chat-header{padding:8px;background:#242427;border-bottom:1px solid #333;font-weight:bold;color:var(--text)}
.chat-body{flex:1;display:flex;overflow:hidden;}
.chat-sidebar{width:120px;background:#1e1e1f;border-right:1px solid #333;overflow-y:auto;}
.chat-contact{padding:8px 10px;cursor:pointer;font-size:0.9em;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.chat-contact:hover{background:#2b2b2e}
.chat-contact.active{background:var(--accent);color:#fff;border-left:3px solid var(--text);}
.chat-messages{flex:1;padding:10px;overflow-y:auto;display:flex;flex-direction:column;gap:8px;}
.message-row{display:flex;max-width:80%;}
.message-row.sent{margin-left:auto;}
.message-bubble{padding:6px 10px;border-radius:12px;font-size:0.9em;line-height:1.4;}
.message-bubble.received{background:#333336;border-top-left-radius:2px;}
.message-bubble.sent{background:var(--accent);color:#fff;border-top-right-radius:2px;}
.chat-input-wrap{padding:8px;background:#242427;display:flex;gap:8px;border-top:1px solid #333;}
.chat-input-wrap input{flex:1;border-radius:20px;padding:6px 12px;border:none;background:#333;color:var(--text);outline:none;}
.chat-input-wrap button{background:var(--accent);border:none;border-radius:50%;width:30px;height:30px;color:#fff;cursor:pointer;font-weight:bold;font-size:1.1em;}

/* Station News UI specific */
.station-news{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;text-align:center;}
.news-title{font-size:1.5em;color:var(--accent);margin-bottom:10px;}
.news-content{padding:20px;background:#333336;border-radius:6px;width:80%;margin-bottom:20px;font-size:0.9em;}
.news-controls{display:flex;gap:20px;font-size:1.5em;}
.news-controls button{background:transparent;border:none;color:var(--accent);cursor:pointer;}

/* footer */
.footer{height:34px;margin-top:0px;background:linear-gradient(180deg,#141414c2,#181818);border-radius:6px;padding:6px 10px;display:flex;justify-content:space-between;align-items:center;border:1px solid rgba(255,255,255,0.02);font-size:13px;color:var(--muted)}

/* chip */
.chip{background:rgba(255,255,255,0.03);padding:6px 8px;border-radius:6px;font-size:13px;color:var(--text)}

/* power overlay */
.power-overlay{
   position:absolute;inset:0;background:rgba(0,0,0,0.85);display:flex;align-items:center;justify-content:center;border-radius:calc(var(--radius) + 6px);
}
.power-box{background:#111;padding:20px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);display:flex;flex-direction:column;align-items:center;gap:12px}
.power-icon{font-size:36px;color:var(--muted)}
.power-text{color:var(--muted)}
.power-btn{padding:8px 12px;border-radius:6px;border:none;background:var(--accent);color:#fff;cursor:pointer}

/* Modal Styling (Ringtone) */
.modal{
   position:absolute;inset:0;background:rgba(0,0,0,0.7);display:flex;align-items:center;justify-content:center;
   z-index:100;
}
.modal-content{
   background:var(--panel);padding:20px;border-radius:8px;border:2px solid var(--accent);
   width:250px;display:flex;flex-direction:column;align-items:center;gap:15px;position:relative;
}
.modal-close{position:absolute;top:5px;right:5px;font-size:1.5em;color:var(--muted);transition:color 0.1s;}
.modal-close:hover{color:var(--danger);}
.modal-title{font-size:1.3em;color:var(--accent);font-weight:bold;}
.ringtone-notes{display:flex;gap:8px;}
.ringtone-notes span{background:#333;padding:5px 10px;border-radius:4px;color:var(--info);font-weight:bold;}
.modal-actions{display:flex;gap:10px;}
.action-btn{padding:8px 15px;border-radius:6px;border:none;background:var(--accent);color:#fff;cursor:pointer;}
.action-btn:hover{background:#7a3c80;}

.ringtone-note-input{
   width: 25px; /* Fixed width for single character */
   text-align: center;
   background: #333;
   padding: 5px 0; /* Padding adjustment due to fixed width */
   border-radius: 4px;
   color: var(--info);
   font-weight: bold;
   border: 1px solid #444; /* Small border */
   outline: none;
   font-family: 'Share Tech Mono', ui-monospace, monospace;
   font-size: 1em;
   text-transform: uppercase; /* Ensure note is uppercase for consistency */
}
.ringtone-note-input:focus {
    border-color: var(--accent); /* Highlight on focus */
}
/* utility */
.hidden{display:none}
.program-mini{font-size:12px;color:var(--muted);margin-left:8px}

@media (max-width: 1280px) { /* Increased from 960px to 1280px */
  /* Adjust layout for smaller screens to stack the PDA and Book */
  body {
    flex-direction: column;
    gap: 20px;
    }
  }

@media (max-width:600px){
   :root{--width:92vw;--height:86vh}
   .pda{width:92vw;height:86vh}
   .program-grid{grid-template-columns:1fr}
}

/* --- Scrollbar Styling for Webkit Browsers (Chrome, Safari, Edge) --- */

/* Track */
::-webkit-scrollbar {
  width: 8px;
   height: 8px;
   background: transparent; /* Makes the main track area invisible */
}

/* Handle (The movable part) */
::-webkit-scrollbar-thumb {
   background: #444448; /* Darker than the panel, but lighter than the track */
   border-radius: 10px;
   border: 2px solid var(--inner); /* Creates a dark border to match the background */
}

/* Handle on hover */
::-webkit-scrollbar-thumb:hover {
   background: #55555c; /* Slightly lighter on hover */
}

/* Corner (where vertical and horizontal meet) */
::-webkit-scrollbar-corner {
   background: transparent;
}

/* Hide scrollbar in Firefox for a cleaner look, but keep scrolling functional */
.view, .notes-wrap, .chat-messages, .manifest-list {
   scrollbar-width: thin; /* "auto" or "thin" */
   scrollbar-color: #444448 var(--inner); /* thumb color track color */
}

.secret-screen {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    overflow: hidden; 
    background-color: var(--pda-bg); 
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    z-index: 999; /* Ensure it's on top of all programs */
    background-size: cover; 
    background-repeat: no-repeat;
    background-position: center;
}

/* Base image style: covers the entire screen */
.secret-image {
    width: 100%;
    height: 100%;
    object-fit: cover; 
}

/* Manic state image style: needs absolute positioning to be underneath the overlay */
.secret-image.manic {
    position: absolute;
    width: 100%;
    height: 100%;
}

.manic-glitch-container {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    /* Ensures the glitch content is on a higher layer than the background image */
    z-index: 10; 
}

/* The actual image element for the glitch */
.glitch-image {
    width: 100%;
    height: 100%;
    /* If the glitch image has transparent areas, this ensures the manic background shows through. */
    object-fit: cover; 
}

/* Update the .secret-screen styles to allow the background image to show */
.click-catcher {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 999; /* Must be high enough to catch clicks over all other elements */
    cursor: pointer;
}

.secret-screen.hidden {
    display: none !important; /* Forces the browser to not render the element at all */
}

/* ------------------------------------------------ */
/* --- CRT/VHS Screen Overlays (No Rolling) --- */
/* ------------------------------------------------ */

/* 1. Base Class: Jitter + Filter */
.secret-screen.vhs-jitter {
    position: relative; 
    overflow: hidden; 
    
    /* Jitter/Screen Shake */
    animation: grain 1s steps(10) infinite;
    
    /* Subtle VCR/CRT color enhancement */
    filter: brightness(1.2) contrast(1.1); 
}

/* 2. Scanline Overlay (::after) - Static Horizontal Lines */
.secret-screen.vhs-jitter::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    
    /* Creates static, dark horizontal lines (Scanlines) */
    background: repeating-linear-gradient(
        transparent 0,
        rgba(0, 0, 0, 0.4) 1px, /* The dark line */
        transparent 1.5px,
        transparent 3px
    );
    z-index: 11; 
    pointer-events: none; 
    mix-blend-mode: overlay; 
    
    /* Subtle flicker animation on the scanlines */
    animation: flicker 0.15s infinite; 
}

/* 3. Screen Flicker/Bloom (::before) - Simulates bloom and overall screen static */
.secret-screen.vhs-jitter::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.1); /* Subtle dark overlay */
    z-index: 12; 
    pointer-events: none;
    
    /* Intense, random opacity flicker */
    animation: intenseFlicker 0.1s steps(2, end) infinite;
}

/* --- Keyframe Animations --- */

/* Jitter Animation (Retained) */
@keyframes grain {
  0%, 100% { transform: translate(0, 0); }
  10% { transform: translate(-1%, -1%); }
  20% { transform: translate(-1%, 1%); }
  30% { transform: translate(1%, -1%); }
  40% { transform: translate(1%, 1%); }
  50% { transform: translate(-1%, -1%); }
  60% { transform: translate(-1%, 1%); }
  70% { transform: translate(1%, -1%); }
  80% { transform: translate(1%, 1%); }
  90% { transform: translate(-1%, -1%); }
}

/* Subtle Flicker for Scanlines */
@keyframes flicker {
    0% { opacity: 0.95; }
    50% { opacity: 1; }
    100% { opacity: 0.95; }
}

/* Intense Flicker for Screen Bloom */
@keyframes intenseFlicker {
    0% { opacity: 0.1; }
    100% { opacity: 0.15; }
}
/* Glitch Class for PDA Title (Assumed to be .title) */
/* ------------------------------------------------ */
/* --- Glitch Effect (Generic) --- */
/* ------------------------------------------------ */

/* Base class applied to ALL glitched elements (.title, .footer .left, #serial) */
.glitch {
    position: relative;
    /* Ensure the element can be clipped properly and prevent wrapping */
    display: inline-block; 
    white-space: nowrap; 
    /* Use the PDA background color to hide the clipping text fragments */
}

/* Pseudo-elements applied to ANY element with .glitch */
.glitch::before,
.glitch::after {
    animation-iteration-count: infinite;
    animation-timing-function: linear;
    animation-direction: alternate-reverse;
    overflow: hidden;
    position: absolute;
    top: 0;
    left: 0; /* Reset left position for generic elements */
    clip: rect(0, 900px, 0, 0);
    content: attr(data-text);
    /* Ensure colors are inherited unless explicitly set by text-shadow */
    color: inherit; 
}

/* --- Glitch Layers --- */

.glitch::after {
    animation-name: glitch-animation;
    animation-duration: 4s;
    left: 4px;
    text-shadow: -1px 0 #ffa800; /* Orange shadow */
}

.glitch::before {
    animation-name: glitch-animation-2;
    animation-duration: 6s;
    left: -4px;
    text-shadow: 1px 0 #00d8ff; /* Cyan shadow */
}

/* --- Keyframe Animations (These remain the same) --- */

/* @keyframes glitch-animation */
@keyframes glitch-animation {
    0% { clip: rect(42px, 9999px, 44px, 0); }
    5% { clip: rect(12px, 9999px, 59px, 0); }
    10% { clip: rect(48px, 9999px, 29px, 0); }
    15.0% { clip: rect(42px, 9999px, 73px, 0); }
    20% { clip: rect(63px, 9999px, 27px, 0); }
    25% { clip: rect(34px, 9999px, 55px, 0); }
    30.0% { clip: rect(86px, 9999px, 73px, 0); }
    35% { clip: rect(20px, 9999px, 20px, 0); }
    40% { clip: rect(26px, 9999px, 60px, 0); }
    45% { clip: rect(25px, 9999px, 66px, 0); }
    50% { clip: rect(57px, 9999px, 98px, 0); }
    55.0% { clip: rect(5px, 9999px, 46px, 0); }
    60.0% { clip: rect(82px, 9999px, 31px, 0); }
    65% { clip: rect(54px, 9999px, 27px, 0); }
    70% { clip: rect(28px, 9999px, 99px, 0); }
    75% { clip: rect(45px, 9999px, 69px, 0); }
    80% { clip: rect(23px, 9999px, 85px, 0); }
    85.0% { clip: rect(54px, 9999px, 84px, 0); }
    90% { clip: rect(45px, 9999px, 47px, 0); }
    95% { clip: rect(37px, 9999px, 20px, 0); }
    100% { clip: rect(4px, 9999px, 91px, 0); }
}

/* @keyframes glitch-animation-2 */
@keyframes glitch-animation-2 {
    0% { clip: rect(65px, 9999px, 100px, 0); }
    5% { clip: rect(52px, 9999px, 74px, 0); }
    10% { clip: rect(79px, 9999px, 85px, 0); }
    15.0% { clip: rect(75px, 9999px, 5px, 0); }
    20% { clip: rect(67px, 9999px, 61px, 0); }
    25% { clip: rect(14px, 9999px, 79px, 0); }
    30.0% { clip: rect(1px, 9999px, 66px, 0); }
    35% { clip: rect(86px, 9999px, 30px, 0); }
    40% { clip: rect(23px, 9999px, 98px, 0); }
    45% { clip: rect(85px, 9999px, 72px, 0); }
    50% { clip: rect(71px, 9999px, 75px, 0); }
    55.0% { clip: rect(2px, 9999px, 48px, 0); }
    60.0% { clip: rect(30px, 9999px, 16px, 0); }
    65% { clip: rect(59px, 9999px, 50px, 0); }
    70% { clip: rect(41px, 9999px, 62px, 0); }
    75% { clip: rect(2px, 9999px, 82px, 0); }
    80% { clip: rect(47px, 9999px, 73px, 0); }
    85.0% { clip: rect(3px, 9999px, 27px, 0); }
    90% { clip: rect(26px, 9999px, 55px, 0); }
    95% { clip: rect(42px, 9999px, 97px, 0); }
    100% { clip: rect(38px, 9999px, 49px, 0); }
}